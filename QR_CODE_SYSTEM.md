# ๐ฑ ูุธุงู QR Code ูุฅูุชุงุฌ ุงููุตูุงุช

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ูุงูู ูุฅูุชุงุฌ ุงููุตูุงุช ูุน QR Codes ูุงุจูุฉ ููุทุจุงุนุฉ. ูู ุจูุฑุดู ูู QR Code ุฎุงุต ุจู ูููู ุทุจุงุนุชู ููุตูู ุนูู ุงูููุณ.

---

## โจ ุงููููุฒุงุช

### 1. ุฅูุชุงุฌ ุงููุตูุฉ
- ุนูุฏ ุฅูุชุงุฌ ูุตูุฉุ ูุชู ุฅูุดุงุก QR Code ูููุตู ููู ุจูุฑุดู
- ูู QR Code ูุญุชูู ุนูู:
  - ุฑูู ุงูุฅูุชุงุฌ (production_id)
  - ุฑูู ุงูุจูุฑุดู (portion_number)
  - ุฅุฌูุงูู ุงูุจูุฑุชุดูุงุช
  - ุงุณู ุงููุตูุฉ
  - ุงููููุฉ ุงูููุชุฌุฉ
  - ูุฒู ุงูุจูุฑุดู
  - ุชุงุฑูุฎ ุงูุฅูุชุงุฌ
  - ุชุงุฑูุฎ ุงูุงูุชูุงุก
  - Reference, Version, Edition

### 2. QR Codes ูุงุจูุฉ ููุทุจุงุนุฉ
- ุตูุญุฉ ุนุฑุถ QR Codes (`recipe-production.html`) ุชุนุฑุถ ุฌููุน QR Codes
- ุชุตููู ูุญุณูู ููุทุจุงุนุฉ:
  - ุนูุฏ ุงูุทุจุงุนุฉ: ูู QR Code ูู ุตูุฏูู ูููุตู
  - ูุนูููุงุช ูุฎุชุตุฑุฉ: ุงุณู ุงููุตูุฉุ ุงููุฒูุ ุงูุชูุงุฑูุฎ
  - ูุงุจู ููุทุจุงุนุฉ ุนูู ููุตูุงุช (labels)
- ุฒุฑ ุทุจุงุนุฉ ูู ุงูุตูุญุฉ

### 3. ูุณุญ QR Code ูุชุณุฌูู ุงูุณุญุจ
- ุนูุฏ ูุณุญ QR Code ูู ุตูุญุฉ ุงูุณุญูุจุงุช (`withdrawals.html`):
  - ูุชู ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช ุชููุงุฆูุงู
  - ูุชู ุชุณุฌูู:
    - **ุงุณู ุงูุดุฎุต** (ุงููุณุชุฎุฏู ุงููุณุฌู ุฏุฎููู)
    - **ููุช ุงูุณุญุจ** (ุชุงุฑูุฎ ูููุช)
    - **ุงููููุฉ ุงููุณุญูุจุฉ** (ุชููุงุฆูุงู = ูุฒู ุงูุจูุฑุดู)
    - **ุงููููุฉ ุงููุชุจููุฉ** ูู ุงููุฎุฒู
  - ูุชู ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงูุฅูุชุงุฌ ุชููุงุฆูุงู

---

## ๐ง ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ

- **Backend**: Node.js + Express
- **Database**: MySQL
- **QR Code Generation**: `qrcode` npm package
- **QR Code Scanning**: Html5Qrcode (frontend)

---

## ๐ ุงูุฌุฏุงูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 1. `recipe_productions`
ูุญุชูู ุนูู ูุนูููุงุช ุงูุฅูุชุงุฌ:
- production_id
- recipe_id
- production_quantity
- portion_weight
- production_date
- expiry_date
- qr_code_data (JSON)
- calculated_ingredients (JSON)

### 2. `production_statistics`
ุฅุญุตุงุฆูุงุช ุงูุฅูุชุงุฌ:
- production_id
- total_withdrawn (ุฅุฌูุงูู ุงููุณุญูุจ)
- remaining_quantity (ุงููููุฉ ุงููุชุจููุฉ)
- withdrawal_count (ุนุฏุฏ ุงูุณุญูุจุงุช)

### 3. `recipe_withdrawals`
ุณุฌูุงุช ุงูุณุญูุจุงุช:
- id
- production_id
- user_id
- withdrawal_quantity
- notes
- created_at

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุฅูุชุงุฌ ูุตูุฉ
1. ุงุฐูุจ ุฅูู ุตูุญุฉ ุงููุตูุงุช (`recipes.html`)
2. ุงุฎุชุฑ ูุตูุฉ ูุงุถุบุท "ุฅูุชุงุฌ ูุตูุฉ"
3. ุฃุฏุฎู:
   - ุงููููุฉ ุงูููุชุฌุฉ
   - ูุฒู ุงูุจูุฑุดู
   - ุชุงุฑูุฎ ุงูุฅูุชุงุฌ
4. ุงุถุบุท "ุฅูุชุงุฌ"
5. ุณุชุธูุฑ ุตูุญุฉ ูุน ุฌููุน QR Codes
6. ุงุถุบุท "ุทุจุงุนุฉ" ูุทุจุงุนุฉ QR Codes

### 2. ุชุณุฌูู ุณุญุจ
1. ุงุฐูุจ ุฅูู ุตูุญุฉ ุงูุณุญูุจุงุช (`withdrawals.html`)
2. ุงุถุบุท "ูุณุญ QR Code"
3. ุงูุณุญ QR Code ูู ุงูููุณ
4. ุณูุชู ุนุฑุถ ูุนูููุงุช ุงูุฅูุชุงุฌ
5. ุฃุถู ููุงุญุธุงุช (ุงุฎุชูุงุฑู)
6. ุงุถุบุท "ุญูุธ"
7. ุณูุชู ุชุณุฌูู:
   - ุงุณูู
   - ููุช ุงูุณุญุจ
   - ุงููููุฉ ุงููุณุญูุจุฉ
   - ุงููููุฉ ุงููุชุจููุฉ

---

## ๐ ูุนูููุงุช ุงูุณุญุจ ุงููุณุฌูุฉ

ุนูุฏ ูุณุญ QR Code ูุชุณุฌูู ุงูุณุญุจุ ูุชู ุญูุธ:

| ุงููุนูููุฉ | ุงููุตุฏุฑ |
|---------|--------|
| ุงุณู ุงูุดุฎุต | `auth_db.users.full_name` ุฃู `username` |
| ููุช ุงูุณุญุจ | `recipe_withdrawals.created_at` |
| ุงููููุฉ ุงููุณุญูุจุฉ | `recipe_withdrawals.withdrawal_quantity` |
| ุงููููุฉ ุงููุชุจููุฉ | `production_statistics.remaining_quantity` |
| ุงุณู ุงููุงุฏุฉ | `recipes.item_name` ุฃู `recipes.name` |

---

## ๐จ๏ธ ุงูุทุจุงุนุฉ

### ุนูุฏ ุงูุทุจุงุนุฉ:
- ูุชู ุฅุฎูุงุก ุงููุนูููุงุช ุงูุชูุตูููุฉ (Header, Ingredients, etc.)
- ูุชู ุนุฑุถ QR Codes ููุท ุจุดูู ููุธู
- ูู QR Code ูู ุตูุฏูู ูููุตู
- ูุนูููุงุช ูุฎุชุตุฑุฉ ููู QR Code:
  - ุฑูู ุงูุจูุฑุดู
  - ุงุณู ุงููุตูุฉ
  - ุงููุฒู
  - ุงูุชูุงุฑูุฎ

### ุงูุฅุนุฏุงุฏุงุช:
- ุญุฌู ุงูุตูุญุฉ: A4 Landscape
- ูููู ุทุจุงุนุฉ ูู QR Code ุนูู ููุตู ูููุตู

---

## ๐ API Endpoints

### POST `/api/recipes/:id/produce`
ุฅูุชุงุฌ ูุตูุฉ ูุฅูุดุงุก QR Codes

**Request Body:**
```json
{
  "production_quantity": 10,
  "portion_weight": 0.5,
  "production_date": "2024-01-15"
}
```

**Response:**
```json
{
  "status": "success",
  "data": {
    "production_id": 1,
    "number_of_portions": 20,
    "qr_codes": [
      {
        "portion_number": 1,
        "qr_code_image": "data:image/png;base64,...",
        "qr_code_data": {...}
      },
      ...
    ]
  }
}
```

### POST `/api/withdrawals/scan`
ูุณุญ QR Code ูุชุณุฌูู ุงูุณุญุจ

**Request Body:**
```json
{
  "qr_code_data": {...},
  "withdrawal_quantity": 0.5,
  "notes": "ููุงุญุธุงุช ุงุฎุชูุงุฑูุฉ"
}
```

**Response:**
```json
{
  "status": "success",
  "data": {
    "id": 1,
    "username": "ุฃุญูุฏ ูุญูุฏ",
    "withdrawal_quantity": 0.5,
    "remaining_quantity": 9.5,
    "created_at": "2024-01-15T10:30:00Z",
    "item_name": "ูุตูุฉ ุงูุดููููุงุชู"
  }
}
```

---

## โ ุงูุชุญูู ูู ุงูุณุญูุจุงุช

ููููู ุนุฑุถ ุฌููุน ุงูุณุญูุจุงุช ูู:
- ุตูุญุฉ ุงูุณุญูุจุงุช (`withdrawals.html`)
- API: `GET /api/withdrawals`

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฃูุงู**: QR Codes ุชุญุชูู ุนูู production_id ููุทุ ูุง ุชุญุชูู ุนูู ูุนูููุงุช ุญุณุงุณุฉ
2. **ุงููููุฉ ุงููุชุจููุฉ**: ูุชู ุชุญุฏูุซูุง ุชููุงุฆูุงู ุนูุฏ ูู ุณุญุจ
3. **ุชุงุฑูุฎ ุงูุงูุชูุงุก**: ูุชู ุงูุชุญูู ููู ุนูุฏ ุงููุณุญ
4. **ุงููููุฉ**: ุนูุฏ ุงููุณุญุ ุงููููุฉ ุชุณุงูู ูุฒู ุงูุจูุฑุดู ุชููุงุฆูุงู (ูููู ุชุนุฏูููุง)

---

**ุขุฎุฑ ุชุญุฏูุซ**: 2024

