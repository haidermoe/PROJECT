<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙÙ„Ùˆ Ø¬Ø§Ø±Øª Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ - A3</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        @page {
            size: A3 landscape;
            margin: 10mm;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'Helvetica', sans-serif;
            direction: rtl;
            background: white;
            padding: 20px;
            width: 420mm; /* A3 landscape width */
            min-height: 297mm; /* A3 landscape height */
        }
        
        .page {
            width: 100%;
            page-break-after: always;
            margin-bottom: 30px;
        }
        
        .page:last-child {
            page-break-after: auto;
        }
        
        h1 {
            text-align: center;
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
            border-bottom: 3px solid #333;
            padding-bottom: 10px;
        }
        
        h2 {
            text-align: center;
            font-size: 20px;
            margin: 20px 0 15px 0;
            color: #555;
            background: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
        }
        
        .mermaid {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            background: white;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            min-height: 400px;
        }
        
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f9f9;
            border: 2px solid #333;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 16px;
            color: #666;
        }
        
        .summary-table {
            width: 100%;
            margin: 20px 0;
            border-collapse: collapse;
            font-size: 12px;
        }
        
        .summary-table th,
        .summary-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        
        .summary-table th {
            background: #333;
            color: white;
            font-weight: bold;
        }
        
        .summary-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        @media print {
            body {
                width: 420mm;
                padding: 0;
            }
            
            .page {
                page-break-after: always;
            }
            
            .mermaid {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“Š ÙÙ„Ùˆ Ø¬Ø§Ø±Øª Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹</h1>
        <p>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø·Ø¹Ù… - Restaurant Management System</p>
        <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: 2024 | Ø§Ù„Ø¥ØµØ¯Ø§Ø±: 1.0</p>
    </div>

    <div class="page">
        <h2>1ï¸âƒ£ ØªØ¯ÙÙ‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (Authentication Flow)</h2>
        <div class="mermaid">
flowchart TD
    Start([Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚]) --> CheckToken{Ù‡Ù„ ÙŠÙˆØ¬Ø¯ ØªÙˆÙƒÙ† ÙÙŠ localStorage?}
    
    CheckToken -->|Ù„Ø§| LoginPage[ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„<br/>index.html]
    CheckToken -->|Ù†Ø¹Ù…| VerifyToken[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ØªÙˆÙƒÙ†<br/>auth-check.js]
    
    LoginPage --> EnterCredentials[Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±]
    EnterCredentials --> ValidateInput[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª<br/>validateLogin middleware]
    
    ValidateInput -->|ØºÙŠØ± ØµØ­ÙŠØ­| ShowError[Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£]
    ShowError --> LoginPage
    
    ValidateInput -->|ØµØ­ÙŠØ­| SendLogin[Ø¥Ø±Ø³Ø§Ù„ POST /auth/login]
    SendLogin --> CheckUser{Ø§Ù„Ø¨Ø­Ø« ÙÙŠ auth_db.users}
    
    CheckUser -->|Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯| ReturnError[Ø¥Ø±Ø¬Ø§Ø¹ Ø®Ø·Ø£ 401]
    ReturnError --> ShowError
    
    CheckUser -->|Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯| CheckPassword[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±<br/>bcrypt.compare]
    
    CheckPassword -->|ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©| ReturnError
    CheckPassword -->|ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØµØ­ÙŠØ­Ø©| CheckActive{Ù‡Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù†Ø´Ø·?<br/>is_active = 1}
    
    CheckActive -->|ØºÙŠØ± Ù†Ø´Ø·| ReturnError
    CheckActive -->|Ù†Ø´Ø·| GenerateToken[Ø¥Ù†Ø´Ø§Ø¡ JWT Token<br/>ÙŠØ­ØªÙˆÙŠ: id, username, role]
    
    GenerateToken --> SaveToken[Ø­ÙØ¸ Ø§Ù„ØªÙˆÙƒÙ† ÙÙŠ localStorage<br/>localStorage.setItem 'token']
    SaveToken --> SaveUser[Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ localStorage<br/>localStorage.setItem 'user']
    
    SaveUser --> Redirect[Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø­Ø³Ø¨ Ø§Ù„Ø±ØªØ¨Ø©]
    
    VerifyToken --> CallAPI[Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ GET /auth/me]
    CallAPI --> CheckResponse{Ù‡Ù„ Ø§Ù„ØªÙˆÙƒÙ† ØµØ§Ù„Ø­?}
    
    CheckResponse -->|ØºÙŠØ± ØµØ§Ù„Ø­| ClearStorage[Ù…Ø³Ø­ localStorage]
    ClearStorage --> LoginPage
    
    CheckResponse -->|ØµØ§Ù„Ø­| CheckPermissions[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª<br/>auth-check.js]
    
    CheckPermissions --> Redirect
    
    Redirect --> AdminDash{Ù‡Ù„ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…?}
    Redirect --> ManagerDash{Ù‡Ù„ Ù…Ø¯ÙŠØ±?}
    Redirect --> KitchenEmp{Ù‡Ù„ Ù…ÙˆØ¸Ù Ù…Ø·Ø¨Ø®?}
    Redirect --> RegularEmp{Ù‡Ù„ Ù…ÙˆØ¸Ù Ø¹Ø§Ø¯ÙŠ?}
    
    AdminDash -->|Ù†Ø¹Ù…| Dashboard[Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…<br/>dashboard/dashboard.html]
    ManagerDash -->|Ù†Ø¹Ù…| Dashboard
    KitchenEmp -->|Ù†Ø¹Ù…| Inventory[ØµÙØ­Ø© Ø§Ù„Ù…Ø®Ø²Ù†<br/>inventory.html]
    RegularEmp -->|Ù†Ø¹Ù…| Attendance[ØµÙØ­Ø© Ø§Ù„Ø¨ØµÙ…Ø©<br/>attendance.html]
    
    Dashboard --> End([ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„])
    Inventory --> End
    Attendance --> End
        </div>
    </div>

    <div class="page">
        <h2>2ï¸âƒ£ ØªØ¯ÙÙ‚ Ø§Ù„ØªÙÙˆÙŠØ¶ ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (Authorization Flow)</h2>
        <div class="mermaid">
flowchart TD
    UserAccess([Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ­Ø§ÙˆÙ„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØµÙØ­Ø©]) --> LoadAuthCheck[ØªØ­Ù…ÙŠÙ„ auth-check.js]
    
    LoadAuthCheck --> HidePage["Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙØ­Ø© Ù…Ø¤Ù‚ØªØ§Ù‹ (display: none)"]
    HidePage --> GetToken[Ø¬Ù„Ø¨ Ø§Ù„ØªÙˆÙƒÙ† Ù…Ù† localStorage]
    
    GetToken --> TokenExists{Ù‡Ù„ ÙŠÙˆØ¬Ø¯ ØªÙˆÙƒÙ†?}
    
    TokenExists -->|Ù„Ø§| RedirectLogin["Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (window.location.replace)"]
    
    TokenExists -->|Ù†Ø¹Ù…| VerifyWithServer["Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ† Ù…Ø¹ Ø§Ù„Ø³ÙŠØ±ÙØ± (GET /auth/me)"]
    
    VerifyWithServer --> TokenValid{Ù‡Ù„ Ø§Ù„ØªÙˆÙƒÙ† ØµØ§Ù„Ø­?}
    
    TokenValid -->|Ù„Ø§| ClearStorage[Ù…Ø³Ø­ localStorage]
    ClearStorage --> RedirectLogin
    
    TokenValid -->|Ù†Ø¹Ù…| GetUserRole["Ø¬Ù„Ø¨ Ø±ØªØ¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (user.role)"]
    
    GetUserRole --> CheckPageAccess{ÙØ­Øµ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©}
    
    CheckPageAccess --> AdminPage{"ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø©? (employees.html, dashboard.html)"}
    CheckPageAccess --> InventoryPage{"ØµÙØ­Ø© Ù…Ø®Ø²Ù†? (inventory.html, withdrawals.html)"}
    CheckPageAccess --> NotificationsPage{"ØµÙØ­Ø© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª? (notifications.html)"}
    CheckPageAccess --> RegularPage{"ØµÙØ­Ø© Ø¹Ø§Ø¯ÙŠØ©? (attendance.html, leaves.html)"}
    
    AdminPage --> IsAdmin{Ù‡Ù„ admin?}
    IsAdmin -->|Ù†Ø¹Ù…| AllowAccess[Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„]
    IsAdmin -->|Ù„Ø§| RedirectToAllowed[Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ù…Ø³Ù…ÙˆØ­Ø©]
    
    InventoryPage --> IsKitchenEmp{"Ù‡Ù„ kitchen_employee Ø£Ùˆ kitchen_manager Ø£Ùˆ admin?"}
    IsKitchenEmp -->|Ù†Ø¹Ù…| AllowAccess
    IsKitchenEmp -->|Ù„Ø§| RedirectToAllowed
    
    NotificationsPage --> IsAdmin2{Ù‡Ù„ admin?}
    IsAdmin2 -->|Ù†Ø¹Ù…| AllowAccess
    IsAdmin2 -->|Ù„Ø§| RedirectToAllowed
    
    RegularPage --> AllowAccess
    
    RedirectToAllowed --> RegularEmpCheck{Ù‡Ù„ Ù…ÙˆØ¸Ù Ø¹Ø§Ø¯ÙŠ?}
    RegularEmpCheck -->|Ù†Ø¹Ù…| RedirectAttendance["Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù€ attendance.html"]
    RegularEmpCheck -->|Ù„Ø§| RedirectInventory["Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù€ inventory.html"]
    
    AllowAccess --> LoadPermissions["ØªØ­Ù…ÙŠÙ„ permissions.js"]
    LoadPermissions --> ApplyPermissions["ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (applyPermissions())"]
    
    ApplyPermissions --> HideRestricted["Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ù‚ÙŠØ¯Ø© (sidebar.js)"]
    HideRestricted --> ShowPage["Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© (display: '')"]
    
    ShowPage --> End([ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ØµÙØ­Ø©])
    RedirectLogin --> End
    RedirectAttendance --> End
    RedirectInventory --> End
        </div>
    </div>

    <div class="page">
        <h2>3ï¸âƒ£ ØªØ¯ÙÙ‚ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (Employee Management Flow)</h2>
        <div class="mermaid">
flowchart TD
    Start([Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù… ÙŠÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†]) --> CheckAuth{"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (isAdmin())"}
    
    CheckAuth -->|ØºÙŠØ± Ù…ØµØ±Ø­| Redirect[Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡]
    CheckAuth -->|Ù…ØµØ±Ø­| LoadEmployees["ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (GET /auth/users)"]
    
    LoadEmployees --> DisplayTable["Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ (employees.js)"]
    
    DisplayTable --> UserAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    
    UserAction -->|Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù| ShowAddModal[ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù]
    UserAction -->|ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆØ¸Ù| ShowEditModal[ÙØªØ­ Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆØ¸Ù]
    UserAction -->|ØªØ¹Ø·ÙŠÙ„/ØªÙØ¹ÙŠÙ„| ToggleUser[ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]
    UserAction -->|Ø­Ø°Ù Ù…ÙˆØ¸Ù| ConfirmDelete[Ø·Ù„Ø¨ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù]
    
    ShowAddModal --> FillForm["Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬: username, password, role, full_name"]
    FillForm --> ValidateForm{"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (validateCreateUser)"}
    
    ValidateForm -->|ØºÙŠØ± ØµØ­ÙŠØ­| ShowError[Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£]
    ValidateForm -->|ØµØ­ÙŠØ­| SendCreate["Ø¥Ø±Ø³Ø§Ù„ POST /auth/users"]
    
    SendCreate --> HashPassword["ØªØ´ÙÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (bcrypt.hash)"]
    HashPassword --> InsertDB[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ auth_db.users]
    
    InsertDB --> Success[Ù†Ø¬Ø§Ø­ - ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    ShowEditModal --> LoadUserData[ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]
    LoadUserData --> FillEditForm[Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©]
    FillEditForm --> ModifyData[ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª]
    ModifyData --> ValidateEdit{Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª}
    
    ValidateEdit -->|ØºÙŠØ± ØµØ­ÙŠØ­| ShowError
    ValidateEdit -->|ØµØ­ÙŠØ­| SendUpdate[Ø¥Ø±Ø³Ø§Ù„ PUT /auth/users/:id]
    
    SendUpdate --> UpdateDB[ØªØ­Ø¯ÙŠØ« auth_db.users]
    UpdateDB --> Success
    
    ToggleUser --> SendToggle[Ø¥Ø±Ø³Ø§Ù„ PUT /auth/users/:id/toggle]
    SendToggle --> UpdateStatus[ØªØ­Ø¯ÙŠØ« is_active ÙÙŠ auth_db.users]
    UpdateStatus --> Success
    
    ConfirmDelete --> UserConfirm{ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    UserConfirm -->|Ø¥Ù„ØºØ§Ø¡| DisplayTable
    UserConfirm -->|ØªØ£ÙƒÙŠØ¯| SendDelete[Ø¥Ø±Ø³Ø§Ù„ DELETE /auth/users/:id]
    
    SendDelete --> DeleteDB[Ø­Ø°Ù Ù…Ù† auth_db.users]
    DeleteDB --> Success
    
    Success --> RefreshTable[ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    RefreshTable --> DisplayTable
    ShowError --> DisplayTable
        </div>
    </div>

    <div class="page">
        <h2>4ï¸âƒ£ ØªØ¯ÙÙ‚ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª (Leave Requests Flow)</h2>
        <div class="mermaid">
flowchart TD
    Start([Ø§Ù„Ù…ÙˆØ¸Ù ÙŠÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª]) --> CheckAuth[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ†]
    
    CheckAuth --> LoadLeaves[ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª<br/>GET /api/leaves/my-leaves]
    
    LoadLeaves --> DisplayLeaves[Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    DisplayLeaves --> UserAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    
    UserAction -->|Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø© Ø¬Ø¯ÙŠØ¯Ø©| ShowRequestForm[ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø©]
    UserAction -->|ÙÙ„ØªØ±Ø©| ApplyFilter[ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±<br/>status, leave_type]
    UserAction -->|Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨| CancelRequest[Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±]
    
    ShowRequestForm --> FillForm[Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:<br/>leave_type, start_date, end_date, reason]
    FillForm --> ValidateDates{Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®}
    
    ValidateDates -->|ØºÙŠØ± ØµØ­ÙŠØ­| ShowError[Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£]
    ValidateDates -->|ØµØ­ÙŠØ­| CalculateDays[Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…]
    
    CalculateDays --> SendRequest[Ø¥Ø±Ø³Ø§Ù„ POST /api/leaves/request]
    
    SendRequest --> InsertLeave[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.leave_requests<br/>status = 'pending']
    
    InsertLeave --> CreateNotification[Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…<br/>createNotification]
    
    CreateNotification --> QueryAdmins[Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ†<br/>SELECT * FROM users WHERE role = 'admin']
    
    QueryAdmins --> LoopAdmins[Ø­Ù„Ù‚Ø© Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ø¯ÙŠØ±]
    LoopAdmins --> InsertNotif[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.notifications<br/>type = 'leave_request']
    
    InsertNotif --> Success[Ù†Ø¬Ø§Ø­ - ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    ApplyFilter --> BuildQuery[Ø¨Ù†Ø§Ø¡ Ø§Ø³ØªØ¹Ù„Ø§Ù… SQL<br/>WHERE status = ? AND leave_type = ?]
    BuildQuery --> FilterResults[ØªØµÙÙŠØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬]
    FilterResults --> DisplayLeaves
    
    CancelRequest --> CheckStatus{Ù‡Ù„ status = 'pending'?}
    
    CheckStatus -->|Ù„Ø§| ShowError2[Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡]
    CheckStatus -->|Ù†Ø¹Ù…| SendCancel[Ø¥Ø±Ø³Ø§Ù„ PUT /api/leaves/:id/cancel]
    
    SendCancel --> UpdateStatus[ØªØ­Ø¯ÙŠØ« status = 'cancelled'<br/>ÙÙŠ app_db.leave_requests]
    
    UpdateStatus --> CreateCancelNotif[Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø¥Ù„ØºØ§Ø¡ Ù„Ù„Ù…Ø¯ÙŠØ±]
    CreateCancelNotif --> Success
    
    Success --> RefreshLeaves[ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª]
    RefreshLeaves --> DisplayLeaves
    
    ShowError --> DisplayLeaves
    ShowError2 --> DisplayLeaves
    
    DisplayLeaves --> AdminView{Ù‡Ù„ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…?}
    
    AdminView -->|Ù†Ø¹Ù…| LoadAllLeaves[ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª<br/>GET /api/leaves/all-leaves]
    AdminView -->|Ù„Ø§| End([Ø§Ù†ØªÙ‡Ù‰])
    
    LoadAllLeaves --> DisplayAllLeaves[Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª]
    
    DisplayAllLeaves --> AdminAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¯ÙŠØ±}
    
    AdminAction -->|Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©| ApproveLeave[Ø¥Ø±Ø³Ø§Ù„ PUT /api/leaves/:id/approve]
    AdminAction -->|Ø§Ù„Ø±ÙØ¶| RejectLeave[Ø¥Ø±Ø³Ø§Ù„ PUT /api/leaves/:id/reject]
    
    ApproveLeave --> UpdateApproved[ØªØ­Ø¯ÙŠØ« status = 'approved']
    RejectLeave --> UpdateRejected[ØªØ­Ø¯ÙŠØ« status = 'rejected']
    
    UpdateApproved --> Success
    UpdateRejected --> Success
        </div>
    </div>

    <div class="page">
        <h2>5ï¸âƒ£ ØªØ¯ÙÙ‚ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²Ù† (Inventory Management Flow)</h2>
        <div class="mermaid">
flowchart TD
    Start([Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ù…Ø®Ø²Ù†]) --> CheckAuth[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ†]
    
    CheckAuth --> CheckRole{ÙØ­Øµ Ø§Ù„Ø±ØªØ¨Ø©}
    
    CheckRole -->|admin/kitchen_manager| FullAccess[ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©]
    CheckRole -->|kitchen_employee| WithdrawOnly[ØµÙ„Ø§Ø­ÙŠØ© Ø³Ø­Ø¨ ÙÙ‚Ø·]
    CheckRole -->|Ù…ÙˆØ¸Ù Ø¹Ø§Ø¯ÙŠ| Redirect[Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡]
    
    FullAccess --> LoadInventory[ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø®Ø²Ù†<br/>GET /api/inventory]
    WithdrawOnly --> LoadInventory
    
    LoadInventory --> DisplayItems[Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ§Ø¯ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    DisplayItems --> UserAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    
    UserAction -->|Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø©| ShowAddForm[ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ©]
    UserAction -->|ØªØ¹Ø¯ÙŠÙ„ Ù…Ø§Ø¯Ø©| ShowEditForm[ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„]
    UserAction -->|Ø³Ø­Ø¨ Ù…Ø§Ø¯Ø©| ShowWithdrawForm[ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø³Ø­Ø¨]
    UserAction -->|Ø¥ÙŠØ¯Ø§Ø¹ Ù…Ø§Ø¯Ø©| ShowDepositForm[ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø¥ÙŠØ¯Ø§Ø¹]
    
    ShowAddForm --> FillAddForm[Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:<br/>name, category, unit, initial_quantity]
    FillAddForm --> ValidateAdd{Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª}
    
    ValidateAdd -->|ØºÙŠØ± ØµØ­ÙŠØ­| ShowError[Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£]
    ValidateAdd -->|ØµØ­ÙŠØ­| SendAdd[Ø¥Ø±Ø³Ø§Ù„ POST /api/inventory]
    
    SendAdd --> InsertItem[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.inventory_items]
    InsertItem --> Success[Ù†Ø¬Ø§Ø­ - ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    ShowEditForm --> LoadItemData[ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ø¯Ø©]
    LoadItemData --> FillEditForm[Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬]
    FillEditForm --> ModifyData[ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª]
    ModifyData --> ValidateEdit{Ø§Ù„ØªØ­Ù‚Ù‚}
    
    ValidateEdit -->|ØºÙŠØ± ØµØ­ÙŠØ­| ShowError
    ValidateEdit -->|ØµØ­ÙŠØ­| SendUpdate[Ø¥Ø±Ø³Ø§Ù„ PUT /api/inventory/:id]
    
    SendUpdate --> UpdateItem[ØªØ­Ø¯ÙŠØ« app_db.inventory_items]
    UpdateItem --> Success
    
    ShowWithdrawForm --> FillWithdrawForm[Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:<br/>item_id, quantity, reason]
    FillWithdrawForm --> CheckQuantity{Ù‡Ù„ Ø§Ù„ÙƒÙ…ÙŠØ© Ù…ØªÙˆÙØ±Ø©?}
    
    CheckQuantity -->|Ù„Ø§| ShowError2[Ø§Ù„ÙƒÙ…ÙŠØ© ØºÙŠØ± ÙƒØ§ÙÙŠØ©]
    CheckQuantity -->|Ù†Ø¹Ù…| SendWithdraw[Ø¥Ø±Ø³Ø§Ù„ POST /api/withdrawals]
    
    SendWithdraw --> InsertWithdrawal[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.withdrawals<br/>type = 'withdrawal']
    
    InsertWithdrawal --> UpdateInventory[ØªØ­Ø¯ÙŠØ« quantity ÙÙŠ app_db.inventory_items<br/>quantity = quantity - withdrawn]
    
    UpdateInventory --> Success
    
    ShowDepositForm --> FillDepositForm[Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:<br/>item_id, quantity]
    FillDepositForm --> SendDeposit[Ø¥Ø±Ø³Ø§Ù„ POST /api/withdrawals<br/>type = 'deposit']
    
    SendDeposit --> InsertDeposit[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.withdrawals<br/>type = 'deposit']
    
    InsertDeposit --> UpdateInventory2[ØªØ­Ø¯ÙŠØ« quantity ÙÙŠ app_db.inventory_items<br/>quantity = quantity + deposited]
    
    UpdateInventory2 --> Success
    
    Success --> RefreshInventory[ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®Ø²Ù†]
    RefreshInventory --> DisplayItems
    
    ShowError --> DisplayItems
    ShowError2 --> DisplayItems
        </div>
    </div>

    <div class="page">
        <h2>6ï¸âƒ£ ØªØ¯ÙÙ‚ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡Ø¯Ø± (Waste Management Flow)</h2>
        <div class="mermaid">
flowchart TD
    Start([Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø·Ø¨Ø® ÙŠÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ù‡Ø¯Ø±]) --> CheckAuth[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ†]
    
    CheckAuth --> CheckRole{Ù‡Ù„ kitchen_manager Ø£Ùˆ admin?}
    
    CheckRole -->|Ù„Ø§| Redirect[Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ - Ù„Ø§ ØµÙ„Ø§Ø­ÙŠØ©]
    CheckRole -->|Ù†Ø¹Ù…| LoadWaste[ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù‡Ø¯Ø±<br/>GET /api/waste]
    
    LoadWaste --> DisplayWaste[Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    DisplayWaste --> UserAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    
    UserAction -->|ØªØ³Ø¬ÙŠÙ„ Ù‡Ø¯Ø± Ø¬Ø¯ÙŠØ¯| ShowAddForm[ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ù‡Ø¯Ø±]
    UserAction -->|Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨| CancelWaste[Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±]
    UserAction -->|ÙÙ„ØªØ±Ø©| ApplyFilter[ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±]
    
    ShowAddForm --> FillForm[Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:<br/>item_name, quantity, unit,<br/>waste_type, reason, waste_date]
    
    FillForm --> ValidateForm{Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª}
    
    ValidateForm -->|ØºÙŠØ± ØµØ­ÙŠØ­| ShowError[Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£]
    ValidateForm -->|ØµØ­ÙŠØ­| SendAdd[Ø¥Ø±Ø³Ø§Ù„ POST /api/waste]
    
    SendAdd --> InsertWaste[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.waste_records<br/>status = 'pending']
    
    InsertWaste --> CreateNotification[Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…<br/>createNotification]
    
    CreateNotification --> QueryAdmins[Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ†<br/>SELECT * FROM users WHERE role = 'admin']
    
    QueryAdmins --> LoopAdmins[Ø­Ù„Ù‚Ø© Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ø¯ÙŠØ±]
    LoopAdmins --> InsertNotif[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.notifications<br/>type = 'waste_submission']
    
    InsertNotif --> Success[Ù†Ø¬Ø§Ø­ - ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    CancelWaste --> CheckStatus{Ù‡Ù„ status = 'pending'?}
    
    CheckStatus -->|Ù„Ø§| ShowError2[Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡]
    CheckStatus -->|Ù†Ø¹Ù…| SendCancel[Ø¥Ø±Ø³Ø§Ù„ PUT /api/waste/:id/cancel]
    
    SendCancel --> UpdateStatus[ØªØ­Ø¯ÙŠØ« status = 'cancelled'<br/>ÙÙŠ app_db.waste_records]
    
    UpdateStatus --> CreateCancelNotif[Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø¥Ù„ØºØ§Ø¡ Ù„Ù„Ù…Ø¯ÙŠØ±]
    CreateCancelNotif --> Success
    
    ApplyFilter --> BuildQuery[Ø¨Ù†Ø§Ø¡ Ø§Ø³ØªØ¹Ù„Ø§Ù… SQL]
    BuildQuery --> FilterResults[ØªØµÙÙŠØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬]
    FilterResults --> DisplayWaste
    
    DisplayWaste --> AdminView{Ù‡Ù„ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…?}
    
    AdminView -->|Ù†Ø¹Ù…| ShowApproveBtn[Ø¹Ø±Ø¶ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©/Ø§Ù„Ø±ÙØ¶]
    AdminView -->|Ù„Ø§| End([Ø§Ù†ØªÙ‡Ù‰])
    
    ShowApproveBtn --> AdminAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¯ÙŠØ±}
    
    AdminAction -->|Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©| ApproveWaste[Ø¥Ø±Ø³Ø§Ù„ PUT /api/waste/:id/approve]
    AdminAction -->|Ø§Ù„Ø±ÙØ¶| RejectWaste[Ø¥Ø±Ø³Ø§Ù„ PUT /api/waste/:id/reject]
    
    ApproveWaste --> UpdateApproved[ØªØ­Ø¯ÙŠØ« status = 'approved']
    ApproveWaste --> UpdateInventory[ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø®Ø²Ù†<br/>quantity = quantity - wasted]
    
    UpdateApproved --> Success
    UpdateInventory --> Success
    
    RejectWaste --> UpdateRejected[ØªØ­Ø¯ÙŠØ« status = 'rejected']
    UpdateRejected --> Success
    
    Success --> RefreshWaste[ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‡Ø¯Ø±]
    RefreshWaste --> DisplayWaste
    
    ShowError --> DisplayWaste
    ShowError2 --> DisplayWaste
        </div>
    </div>

    <div class="page">
        <h2>7ï¸âƒ£ ØªØ¯ÙÙ‚ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (Notifications Flow)</h2>
        <div class="mermaid">
flowchart TD
    Start([Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù… ÙŠÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚]) --> CheckAuth[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ†]
    
    CheckAuth --> CheckAdmin{Ù‡Ù„ admin?}
    
    CheckAdmin -->|Ù„Ø§| HideNotifications[Ø¥Ø®ÙØ§Ø¡ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª]
    CheckAdmin -->|Ù†Ø¹Ù…| LoadNotifications[ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª<br/>GET /api/notifications]
    
    LoadNotifications --> QueryDB[Ø§Ø³ØªØ¹Ù„Ø§Ù… app_db.notifications<br/>WHERE user_id = ?<br/>ORDER BY created_at DESC]
    
    QueryDB --> GetUnreadCount[Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©<br/>WHERE is_read = 0]
    
    GetUnreadCount --> DisplayNotifications[Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙŠ Dashboard]
    
    DisplayNotifications --> ShowBadge[Ø¹Ø±Ø¶ Ø´Ø§Ø±Ø© Ø§Ù„Ø¹Ø¯Ø¯<br/>notification-badge]
    
    ShowBadge --> UserAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    
    UserAction -->|ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª| LoadAllNotifications[ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª<br/>GET /api/notifications?limit=100]
    
    UserAction -->|ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ| AutoRefresh[ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©<br/>setInterval]
    
    UserAction -->|Ù‚Ø±Ø§Ø¡Ø© Ø¥Ø´Ø¹Ø§Ø±| MarkRead[ØªØ­Ø¯ÙŠØ¯ ÙƒÙ…Ù‚Ø±ÙˆØ¡<br/>PUT /api/notifications/:id/read]
    
    UserAction -->|Ø­Ø°Ù Ø¥Ø´Ø¹Ø§Ø±| DeleteNotif[Ø­Ø°Ù Ø¥Ø´Ø¹Ø§Ø±<br/>DELETE /api/notifications/:id]
    
    UserAction -->|Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙƒÙ„| MarkAllRead[ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡<br/>PUT /api/notifications/read-all]
    
    LoadAllNotifications --> DisplayAll[Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª<br/>notifications.html]
    
    MarkRead --> UpdateDB[ØªØ­Ø¯ÙŠØ« is_read = 1<br/>ÙÙŠ app_db.notifications]
    
    UpdateDB --> UpdateCount[ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯]
    UpdateCount --> RefreshDisplay[ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶]
    
    DeleteNotif --> DeleteFromDB[Ø­Ø°Ù Ù…Ù† app_db.notifications]
    DeleteFromDB --> RefreshDisplay
    
    MarkAllRead --> UpdateAllDB[ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ is_read = 1<br/>WHERE user_id = ?]
    UpdateAllDB --> UpdateCount
    
    AutoRefresh --> LoadNotifications
    
    RefreshDisplay --> DisplayNotifications
    
    DisplayAll --> FilterOptions{Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙÙ„ØªØ±Ø©}
    
    FilterOptions -->|ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø© ÙÙ‚Ø·| FilterUnread[GET /api/notifications?unread_only=true]
    FilterOptions -->|Ø§Ù„ÙƒÙ„| LoadAllNotifications
    
    FilterUnread --> DisplayAll
    
    DisplayAll --> NotifClick{Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¥Ø´Ø¹Ø§Ø±}
    
    NotifClick --> CheckType{Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±}
    
    CheckType -->|leave_request| RedirectLeaves[Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª]
    CheckType -->|waste_submission| RedirectWaste[Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ù‡Ø¯Ø±]
    
    RedirectLeaves --> End([Ø§Ù†ØªÙ‡Ù‰])
    RedirectWaste --> End
    HideNotifications --> End
        </div>
    </div>

    <div class="page">
        <h2>8ï¸âƒ£ ØªØ¯ÙÙ‚ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (Notification Creation Flow)</h2>
        <div class="mermaid">
flowchart TD
    Event([Ø­Ø¯Ø« ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…]) --> CheckEventType{Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¯Ø«}
    
    CheckEventType -->|Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø©| LeaveRequest[requestLeave ÙÙŠ leavesController.js]
    CheckEventType -->|ØªØ³Ø¬ÙŠÙ„ Ù‡Ø¯Ø±| WasteSubmission[addWaste ÙÙŠ wasteController.js]
    CheckEventType -->|Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø©| CancelLeave[Cancel Leave Request]
    CheckEventType -->|Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ù‡Ø¯Ø±| CancelWaste[Cancel Waste Request]
    
    LeaveRequest --> CreateLeaveNotif[Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ createNotification<br/>type: 'leave_request']
    WasteSubmission --> CreateWasteNotif[Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ createNotification<br/>type: 'waste_submission']
    CancelLeave --> CreateCancelLeaveNotif[Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ createNotification<br/>type: 'leave_cancelled']
    CancelWaste --> CreateCancelWasteNotif[Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ createNotification<br/>type: 'waste_cancelled']
    
    CreateLeaveNotif --> QueryAdmins[Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ†<br/>SELECT * FROM users<br/>WHERE role = 'admin'<br/>AND is_active = 1]
    
    CreateWasteNotif --> QueryAdmins
    CreateCancelLeaveNotif --> QueryAdmins
    CreateCancelWasteNotif --> QueryAdmins
    
    QueryAdmins --> LoopAdmins[Ø­Ù„Ù‚Ø© Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ø¯ÙŠØ±]
    
    LoopAdmins --> BuildMessage[Ø¨Ù†Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±]
    
    BuildMessage --> InsertNotif[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.notifications<br/>INSERT INTO notifications<br/>user_id, type, reference_id,<br/>title, message, is_read = 0]
    
    InsertNotif --> Success[Ù†Ø¬Ø§Ø­ - ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±]
    
    Success --> NotifyFrontend{Ù‡Ù„ Frontend Ù…ØªØµÙ„?}
    
    NotifyFrontend -->|Ù†Ø¹Ù…| UpdateBadge[ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø© Ø§Ù„Ø¹Ø¯Ø¯ ÙÙŠ Dashboard]
    NotifyFrontend -->|Ù„Ø§| WaitForLoad[Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Dashboard]
    
    UpdateBadge --> End([Ø§Ù†ØªÙ‡Ù‰])
    WaitForLoad --> UpdateBadge
        </div>
    </div>

    <div class="page">
        <h2>9ï¸âƒ£ ØªØ¯ÙÙ‚ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø±ØªØ¨ (Role-Based Permissions Flow)</h2>
        <div class="mermaid">
flowchart TD
    User([Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]) --> GetRole["Ø¬Ù„Ø¨ Ø§Ù„Ø±ØªØ¨Ø© Ù…Ù† localStorage (user.role)"]
    
    GetRole --> RoleType{Ù†ÙˆØ¹ Ø§Ù„Ø±ØªØ¨Ø©}
    
    RoleType -->|admin| AdminPerms[ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…]
    RoleType -->|manager| ManagerPerms[ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠØ±]
    RoleType -->|kitchen_manager| KitchenManagerPerms[ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø·Ø¨Ø®]
    RoleType -->|kitchen_employee| KitchenEmployeePerms[ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø·Ø¨Ø®]
    RoleType -->|employee/waiter/captain/etc| RegularEmployeePerms[ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø¹Ø§Ø¯ÙŠ]
    
    AdminPerms --> AdminAccess["Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„ÙƒØ§Ù…Ù„: Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§ØªØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†ØŒ Ø§Ù„Ù…Ø®Ø²Ù†ØŒ Ø§Ù„ÙˆØµÙØ§ØªØŒ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©ØŒ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"]
    
    ManagerPerms --> ManagerAccess["Ø§Ù„ÙˆØµÙˆÙ„: Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…ØŒ Ø§Ù„Ù…Ø®Ø²Ù†ØŒ Ø§Ù„ÙˆØµÙØ§ØªØŒ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© | Ù„Ø§: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†ØŒ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"]
    
    KitchenManagerPerms --> KitchenManagerAccess["Ø§Ù„ÙˆØµÙˆÙ„: Ø§Ù„Ù…Ø®Ø²Ù†ØŒ Ø§Ù„ÙˆØµÙØ§ØªØŒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø±ØŒ Ø§Ù„Ø¨ØµÙ…Ø©ØŒ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª | Ù„Ø§: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†ØŒ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"]
    
    KitchenEmployeePerms --> KitchenEmployeeAccess["Ø§Ù„ÙˆØµÙˆÙ„: Ø§Ù„Ù…Ø®Ø²Ù† Ù‚Ø±Ø§Ø¡Ø©ØŒ Ø§Ù„Ø³Ø­ÙˆØ¨Ø§Øª Ø³Ø­Ø¨ ÙÙ‚Ø·ØŒ Ø§Ù„Ø¨ØµÙ…Ø©ØŒ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª | Ù„Ø§: Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ§Ø¯ØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†ØŒ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"]
    
    RegularEmployeePerms --> RegularEmployeeAccess["Ø§Ù„ÙˆØµÙˆÙ„: Ø§Ù„Ø¨ØµÙ…Ø©ØŒ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª | Ù„Ø§: Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰"]
    
    AdminAccess --> ApplySidebar["ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¹Ù„Ù‰ Sidebar (sidebar.js)"]
    ManagerAccess --> ApplySidebar
    KitchenManagerAccess --> ApplySidebar
    KitchenEmployeeAccess --> ApplySidebar
    RegularEmployeeAccess --> ApplySidebar
    
    ApplySidebar --> HideRestricted["Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ù‚ÙŠØ¯Ø© (menu-item.style.display = 'none')"]
    
    HideRestricted --> ApplyPagePerms["ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© (permissions.js)"]
    
    ApplyPagePerms --> CheckAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    
    CheckAction -->|Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù| CheckPermission{"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: canManageUsers(), canManageRecipes(), canAddInventory()"}
    
    CheckPermission -->|ØºÙŠØ± Ù…ØµØ±Ø­| ShowError["Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ø£Ùˆ Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø²Ø±"]
    CheckPermission -->|Ù…ØµØ±Ø­| AllowAction[Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡]
    
    AllowAction --> ExecuteAction[ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡]
    ShowError --> End([Ø§Ù†ØªÙ‡Ù‰])
    ExecuteAction --> End
        </div>
    </div>

    <div class="page">
        <h2>ğŸ”Ÿ ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ØµÙ…Ø© (Attendance Flow)</h2>
        <div class="mermaid">
flowchart TD
    Start([Ø§Ù„Ù…ÙˆØ¸Ù ÙŠÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¨ØµÙ…Ø©]) --> CheckAuth[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ†]
    
    CheckAuth --> LoadAttendance["ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¨ØµÙ…Ø© (GET /api/attendance/my-attendance)"]
    
    LoadAttendance --> DisplayRecords[Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    DisplayRecords --> UserAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    
    UserAction -->|ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„| RecordCheckIn["Ø¥Ø±Ø³Ø§Ù„ POST /api/attendance/check-in"]
    UserAction -->|ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬| RecordCheckOut["Ø¥Ø±Ø³Ø§Ù„ POST /api/attendance/check-out"]
    UserAction -->|Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª| ShowStats[Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª]
    
    RecordCheckIn --> CheckToday{Ù‡Ù„ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…?}
    
    CheckToday -->|Ù†Ø¹Ù…| ShowError["Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©: ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø³Ø¨Ù‚Ø§Ù‹"]
    CheckToday -->|Ù„Ø§| InsertCheckIn["Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.attendance (check_in_time = NOW(), check_out_time = NULL)"]
    
    InsertCheckIn --> Success[Ù†Ø¬Ø§Ø­ - ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    RecordCheckOut --> CheckCheckIn{Ù‡Ù„ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…?}
    
    CheckCheckIn -->|Ù„Ø§| ShowError2["Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©: ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹"]
    CheckCheckIn -->|Ù†Ø¹Ù…| CheckCheckOut{Ù‡Ù„ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ø§Ù„ÙŠÙˆÙ…?}
    
    CheckCheckOut -->|Ù†Ø¹Ù…| ShowError3["Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©: ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ø³Ø¨Ù‚Ø§Ù‹"]
    CheckCheckOut -->|Ù„Ø§| UpdateCheckOut["ØªØ­Ø¯ÙŠØ« app_db.attendance (check_out_time = NOW(), WHERE user_id = ? AND DATE(check_in_time) = CURDATE())"]
    
    UpdateCheckOut --> CalculateHours["Ø­Ø³Ø§Ø¨ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„ (TIMEDIFF(check_out_time, check_in_time))"]
    
    CalculateHours --> UpdateHours[ØªØ­Ø¯ÙŠØ« total_hours]
    UpdateHours --> Success
    
    ShowStats --> LoadStats["ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª (GET /api/attendance/stats)"]
    
    LoadStats --> CalculateStats["Ø­Ø³Ø§Ø¨: Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ØŒ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§ØªØŒ Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©"]
    
    CalculateStats --> DisplayStats[Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª]
    
    Success --> RefreshAttendance[ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨ØµÙ…Ø©]
    RefreshAttendance --> DisplayRecords
    
    ShowError --> DisplayRecords
    ShowError2 --> DisplayRecords
    ShowError3 --> DisplayRecords
    DisplayStats --> End([Ø§Ù†ØªÙ‡Ù‰])
        </div>
    </div>

    <div class="page">
        <h2>1ï¸âƒ£1ï¸âƒ£ ØªØ¯ÙÙ‚ Ø§Ù„ÙˆØµÙØ§Øª (Recipes Flow)</h2>
        <div class="mermaid">
flowchart TD
    Start([Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙØªØ­ ØµÙØ­Ø© Ø§Ù„ÙˆØµÙØ§Øª]) --> CheckAuth[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ†]
    
    CheckAuth --> CheckRole{ÙØ­Øµ Ø§Ù„Ø±ØªØ¨Ø©}
    
    CheckRole -->|admin/kitchen_manager| FullAccess[ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©]
    CheckRole -->|Ù…ÙˆØ¸Ù Ø¹Ø§Ø¯ÙŠ| ViewOnly[ØµÙ„Ø§Ø­ÙŠØ© Ø¹Ø±Ø¶ ÙÙ‚Ø·]
    CheckRole -->|ØºÙŠØ± Ù…ØµØ±Ø­| Redirect[Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡]
    
    FullAccess --> LoadRecipes["ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØµÙØ§Øª (GET /api/recipes)"]
    ViewOnly --> LoadRecipes
    
    LoadRecipes --> DisplayRecipes[Ø¹Ø±Ø¶ Ø§Ù„ÙˆØµÙØ§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    DisplayRecipes --> UserAction{Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    
    UserAction -->|Ø¥Ø¶Ø§ÙØ© ÙˆØµÙØ©| ShowAddForm[ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© ÙˆØµÙØ©]
    UserAction -->|ØªØ¹Ø¯ÙŠÙ„ ÙˆØµÙØ©| ShowEditForm[ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ ÙˆØµÙØ©]
    UserAction -->|Ø­Ø°Ù ÙˆØµÙØ©| ConfirmDelete[Ø·Ù„Ø¨ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù]
    UserAction -->|Ø¹Ø±Ø¶ ÙˆØµÙØ©| ViewRecipe[ÙØªØ­ ØµÙØ­Ø© Ø¹Ø±Ø¶ Ø§Ù„ÙˆØµÙØ©]
    UserAction -->|Ø¥Ù†ØªØ§Ø¬ ÙˆØµÙØ©| ProduceRecipe[ÙØªØ­ ØµÙØ­Ø© Ø¥Ù†ØªØ§Ø¬ ÙˆØµÙØ©]
    
    ShowAddForm --> FillForm["Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬: name, description, category, ingredients[], quantities[], units[]"]
    
    FillForm --> ValidateForm{Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª}
    
    ValidateForm -->|ØºÙŠØ± ØµØ­ÙŠØ­| ShowError[Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£]
    ValidateForm -->|ØµØ­ÙŠØ­| SendAdd["Ø¥Ø±Ø³Ø§Ù„ POST /api/recipes"]
    
    SendAdd --> InsertRecipe[Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ app_db.recipes]
    
    InsertRecipe --> InsertIngredients[Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ÙÙŠ app_db.recipe_ingredients]
    
    InsertIngredients --> Success[Ù†Ø¬Ø§Ø­ - ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„]
    
    ShowEditForm --> CheckPermission{Ù‡Ù„ kitchen_manager?}
    
    CheckPermission -->|Ù†Ø¹Ù…| NeedsApproval[ÙŠØ­ØªØ§Ø¬ Ù…ÙˆØ§ÙÙ‚Ø©]
    CheckPermission -->|Ù„Ø§| DirectEdit[ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±]
    
    NeedsApproval --> CreateApprovalRequest["Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ù…ÙˆØ§ÙÙ‚Ø© (app_db.approval_requests)"]
    
    CreateApprovalRequest --> NotifyAdmin[Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…]
    NotifyAdmin --> WaitApproval[Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©]
    
    WaitApproval --> Approved{Ù‡Ù„ ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©?}
    
    Approved -->|Ù†Ø¹Ù…| DirectEdit
    Approved -->|Ù„Ø§| ShowError2[ØªÙ… Ø±ÙØ¶ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„]
    
    DirectEdit --> LoadRecipeData[ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØµÙØ©]
    LoadRecipeData --> FillEditForm[Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬]
    FillEditForm --> ModifyData[ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª]
    ModifyData --> ValidateEdit{Ø§Ù„ØªØ­Ù‚Ù‚}
    
    ValidateEdit -->|ØºÙŠØ± ØµØ­ÙŠØ­| ShowError
    ValidateEdit -->|ØµØ­ÙŠØ­| SendUpdate[Ø¥Ø±Ø³Ø§Ù„ PUT /api/recipes/:id]
    
    SendUpdate --> UpdateRecipe[ØªØ­Ø¯ÙŠØ« app_db.recipes]
    UpdateRecipe --> UpdateIngredients[ØªØ­Ø¯ÙŠØ« app_db.recipe_ingredients]
    UpdateIngredients --> Success
    
    ConfirmDelete --> UserConfirm{ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…}
    
    UserConfirm -->|Ø¥Ù„ØºØ§Ø¡| DisplayRecipes
    UserConfirm -->|ØªØ£ÙƒÙŠØ¯| SendDelete[Ø¥Ø±Ø³Ø§Ù„ DELETE /api/recipes/:id]
    
    SendDelete --> DeleteIngredients[Ø­Ø°Ù Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ù…Ù† app_db.recipe_ingredients]
    DeleteIngredients --> DeleteRecipe[Ø­Ø°Ù Ù…Ù† app_db.recipes]
    DeleteRecipe --> Success
    
    ViewRecipe --> LoadFullRecipe["ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØµÙØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø© (GET /api/recipes/:id)"]
    
    LoadFullRecipe --> DisplayFull["Ø¹Ø±Ø¶ Ø§Ù„ÙˆØµÙØ© Ù…Ø¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª (recipe-viewer.html)"]
    
    ProduceRecipe --> LoadRecipeForProduction[ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØµÙØ© Ù„Ù„Ø¥Ù†ØªØ§Ø¬]
    
    LoadRecipeForProduction --> CheckInventory[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙˆÙØ± Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†]
    
    CheckInventory --> AllAvailable{Ù‡Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ù…ØªÙˆÙØ±Ø©?}
    
    AllAvailable -->|Ù„Ø§| ShowError3[Ø¨Ø¹Ø¶ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©]
    AllAvailable -->|Ù†Ø¹Ù…| CalculateRequired[Ø­Ø³Ø§Ø¨ Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©]
    
    CalculateRequired --> ShowProductionForm["Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ (recipe-production.html)"]
    
    ShowProductionForm --> UserConfirmProduction{ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ù†ØªØ§Ø¬}
    
    UserConfirmProduction -->|Ø¥Ù„ØºØ§Ø¡| DisplayRecipes
    UserConfirmProduction -->|ØªØ£ÙƒÙŠØ¯| ProcessProduction[Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬]
    
    ProcessProduction --> DeductInventory[Ø®ØµÙ… Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ø®Ø²Ù†]
    DeductInventory --> RecordProduction[ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ ÙÙŠ app_db.productions]
    
    RecordProduction --> Success
    
    Success --> RefreshRecipes[ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆØµÙØ§Øª]
    RefreshRecipes --> DisplayRecipes
    
    ShowError --> DisplayRecipes
    ShowError2 --> DisplayRecipes
    ShowError3 --> DisplayRecipes
    DisplayFull --> End([Ø§Ù†ØªÙ‡Ù‰])
        </div>
    </div>

    <div class="page">
        <h2>1ï¸âƒ£2ï¸âƒ£ ØªØ¯ÙÙ‚ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Database Flow)</h2>
        <div class="mermaid">
flowchart TD
    App([Ø§Ù„ØªØ·Ø¨ÙŠÙ‚]) --> CheckDB{Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©}
    
    CheckDB -->|Ù…ØµØ§Ø¯Ù‚Ø©/Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†| AuthDB[("auth_db - Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©")]
    CheckDB -->|Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚| AppDB[("app_db - Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©")]
    
    AuthDB --> AuthTables["Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„: users (id, username, password hashed, role, full_name, is_active, created_at)"]
    
    AppDB --> AppTables["Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„: inventory_items, recipes, recipe_ingredients, withdrawals, waste_records, leave_requests, attendance, notifications, approval_requests, productions"]
    
    AuthTables --> AuthConnection["Ø§ØªØµØ§Ù„ Ù…Ø¹Ø²ÙˆÙ„ (authConnection.js, authPool)"]
    
    AppTables --> AppConnection["Ø§ØªØµØ§Ù„ Ù…Ø¹Ø²ÙˆÙ„ (appConnection.js, appPool)"]
    
    AuthConnection --> AuthMiddleware["Middleware Ù„Ù„ØªØ­Ù‚Ù‚ (authMiddleware.js)"]
    
    AppConnection --> AppControllers["Controllers: inventoryController, recipesController, leavesController, wasteController, notificationsController, attendanceController"]
    
    AuthMiddleware --> VerifyToken[Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† JWT Token]
    
    VerifyToken --> ExtractUser["Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (id, username, role)"]
    
    ExtractUser --> PassToController["ØªÙ…Ø±ÙŠØ± req.user Ù„Ù„Ù€ Controller"]
    
    PassToController --> AppControllers
    
    AppControllers --> QueryDB[ØªÙ†ÙÙŠØ° Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª SQL]
    
    QueryDB --> ReturnResults[Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬]
    
    ReturnResults --> JSONResponse["Ø§Ø³ØªØ¬Ø§Ø¨Ø© JSON ({ status, data, message })"]
    
    JSONResponse --> Frontend["Frontend (JavaScript)"]
    
    Frontend --> UpdateUI[ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]
    
    UpdateUI --> End([Ø§Ù†ØªÙ‡Ù‰])
        </div>
    </div>

    <div class="page">
        <h2>ğŸ”„ ØªØ¯ÙÙ‚ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (Error Handling Flow)</h2>
        <div class="mermaid">
flowchart TD
    Request([Ø·Ù„Ø¨ Ù…Ù† Frontend]) --> SendRequest[Ø¥Ø±Ø³Ø§Ù„ Request]
    
    SendRequest --> ServerReceive[Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ÙÙŠ Server]
    
    ServerReceive --> Middleware[Middleware Processing]
    
    Middleware --> Validation{"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (validateLogin, validateCreateUser)"}
    
    Validation -->|ÙØ´Ù„| Return400["Ø¥Ø±Ø¬Ø§Ø¹ 400 Bad Request ({ status: 'error', message: '...' })"]
    
    Validation -->|Ù†Ø¬Ø§Ø­| AuthCheck{"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ† (authMiddleware)"}
    
    AuthCheck -->|ØºÙŠØ± Ù…ØµØ±Ø­| Return401["Ø¥Ø±Ø¬Ø§Ø¹ 401 Unauthorized ({ status: 'error', message: '...' })"]
    
    AuthCheck -->|Ù…ØµØ±Ø­| RoleCheck{"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±ØªØ¨Ø© (requireRole)"}
    
    RoleCheck -->|ØºÙŠØ± Ù…ØµØ±Ø­| Return403["Ø¥Ø±Ø¬Ø§Ø¹ 403 Forbidden ({ status: 'error', message: '...' })"]
    
    RoleCheck -->|Ù…ØµØ±Ø­| Controller[Controller Processing]
    
    Controller --> DBQuery[Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª]
    
    DBQuery --> DBError{Ù‡Ù„ Ø­Ø¯Ø« Ø®Ø·Ø£?}
    
    DBError -->|Ù†Ø¹Ù…| LogError["ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø·Ø£ ÙÙŠ Console (console.error)"]
    
    LogError --> Return500["Ø¥Ø±Ø¬Ø§Ø¹ 500 Internal Server Error ({ status: 'error', message: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±' })"]
    
    DBError -->|Ù„Ø§| ProcessResults[Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬]
    
    ProcessResults --> Return200["Ø¥Ø±Ø¬Ø§Ø¹ 200 OK ({ status: 'success', data: [...] })"]
    
    Return400 --> FrontendError[Frontend ÙŠØªÙ„Ù‚Ù‰ Ø§Ù„Ø®Ø·Ø£]
    Return401 --> FrontendError
    Return403 --> FrontendError
    Return500 --> FrontendError
    Return200 --> FrontendSuccess[Frontend ÙŠØªÙ„Ù‚Ù‰ Ø§Ù„Ù†Ø¬Ø§Ø­]
    
    FrontendError --> ShowErrorMsg["Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… (alert() Ø£Ùˆ toast)"]
    
    FrontendSuccess --> UpdateUI[ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]
    
    ShowErrorMsg --> End([Ø§Ù†ØªÙ‡Ù‰])
    UpdateUI --> End
        </div>
    </div>

    <div class="page">
        <h2>ğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø±ØªØ¨</h2>
        <table class="summary-table">
            <thead>
                <tr>
                    <th>Ø§Ù„Ø±ØªØ¨Ø©</th>
                    <th>Ø§Ù„Ø¨ØµÙ…Ø©</th>
                    <th>Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª</th>
                    <th>Ø§Ù„Ù…Ø®Ø²Ù†</th>
                    <th>Ø§Ù„Ø³Ø­ÙˆØ¨Ø§Øª</th>
                    <th>Ø§Ù„ÙˆØµÙØ§Øª</th>
                    <th>Ø§Ù„Ù‡Ø¯Ø±</th>
                    <th>Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</th>
                    <th>Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</th>
                    <th>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>admin</strong></td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                </tr>
                <tr>
                    <td><strong>manager</strong></td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âœ…</td>
                </tr>
                <tr>
                    <td><strong>kitchen_manager</strong></td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                </tr>
                <tr>
                    <td><strong>kitchen_employee</strong></td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>ğŸ‘ï¸ (Ù‚Ø±Ø§Ø¡Ø©)</td>
                    <td>âœ… (Ø³Ø­Ø¨ ÙÙ‚Ø·)</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                </tr>
                <tr>
                    <td><strong>employee</strong></td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                </tr>
                <tr>
                    <td><strong>waiter/captain/etc</strong></td>
                    <td>âœ…</td>
                    <td>âœ…</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                    <td>âŒ</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html>

